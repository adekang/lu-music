{"version":3,"file":"index-legacy.661500ee.js","sources":["../../src/components/Horizon/index.tsx","../../src/pages/Singers/index.tsx"],"sourcesContent":["import React, { useEffect, useRef } from \"react\";\nimport Scroll from \"@/components/Scroll\";\nimport \"./index.scss\";\n\ninterface Props {\n  list: { name: string; key: string }[];\n  oldVal: string;\n  title: string;\n  handleClick: (key: string) => void;\n}\n\nconst Horizon: React.FC<Props> = props => {\n  const { list = [], oldVal = \"\", title = \"\", handleClick = null } = props;\n\n  const listRef = useRef<any>();\n\n  useEffect(() => {\n    const categoryDOM = listRef.current;\n    const tagElems = categoryDOM.querySelectorAll(\"span\");\n    let totalWidth = 0;\n    Array.from(tagElems).forEach(ele => {\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-ignore\n      totalWidth += ele.offsetWidth;\n    });\n    categoryDOM.style.width = `${totalWidth}px`;\n  }, []);\n  return (\n    <Scroll direction={\"horizontal\"}>\n      <div className=\"ListItem\" ref={listRef}>\n        <span>{title}</span>\n        {list.map(item => {\n          return (\n            <span\n              onClick={() => {\n                handleClick && handleClick(item.key);\n              }}\n              className={`${oldVal === item.key ? \"selected\" : \"\"}`}\n              key={item.key}\n            >\n              {item.name}\n            </span>\n          );\n        })}\n      </div>\n    </Scroll>\n  );\n};\nexport default Horizon;\n","import React, { FC, memo, useEffect, useState } from \"react\";\nimport Scroll from \"@/components/Scroll\";\nimport styles from \"./singers.module.scss\";\nimport { alphaTypes, categoryTypes } from \"@/utils\";\nimport Horizon from \"@/components/Horizon\";\nimport Loading from \"@/components/Loading\";\nimport { Image } from \"antd-mobile\";\nimport { RootState, useAppDispatch } from \"@/store\";\nimport { useSelector } from \"react-redux\";\nimport {\n  changeEnterLoading,\n  changePageCount,\n  changePullDownLoading,\n  changePullUpLoading,\n  getHotSingerList,\n  getSingerList,\n  refreshMoreHotSingerList,\n  refreshMoreSingerList\n} from \"@/store/singersSlice\";\nimport { Outlet, useNavigate } from \"react-router-dom\";\n\nconst Singers: FC = function () {\n  const [category, setCategory] = useState(\"\");\n  const [alpha, setAlpha] = useState(\"\");\n\n  const { singerList, enterLoading, pullDownLoading, pullUpLoading, pageCount } = useSelector(\n    (state: RootState) => state.singers\n  );\n\n  const dispatch = useAppDispatch();\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    dispatch(changeEnterLoading(true));\n    dispatch(getSingerList(category, alpha));\n  }, [alpha, category]);\n\n  useEffect(() => {\n    dispatch(changePageCount(0));\n    dispatch(changeEnterLoading(true));\n    dispatch(getHotSingerList());\n  }, []);\n\n  const handleUpdateCategory = (val: string) => {\n    setCategory(val);\n  };\n\n  const handleUpdateAlpha = (val: string) => {\n    setAlpha(val);\n  };\n\n  const changeHotMode = (category: string, alpha: string, hot: boolean) => {\n    if (hot) {\n      dispatch(refreshMoreHotSingerList());\n    } else {\n      dispatch(refreshMoreSingerList(category, alpha));\n    }\n  };\n\n  const handlePullUp = () => {\n    dispatch(changePageCount(pageCount + 30));\n    dispatch(changePullDownLoading(true));\n    if (category === \"\" && alpha === \"\") {\n      changeHotMode(category, alpha, true);\n    } else {\n      changeHotMode(category, alpha, false);\n    }\n  };\n\n  const handlePullDown = () => {\n    dispatch(changePageCount(0));\n    dispatch(changePullUpLoading(true));\n    if (category === \"\" && alpha === \"\") {\n      dispatch(getHotSingerList());\n    } else {\n      dispatch(getSingerList(category, alpha));\n    }\n  };\n\n\n  return (\n    <div>\n      <div className={styles.NavContainer}>\n        <Horizon\n          list={categoryTypes}\n          title={\"分类(默认热门):\"}\n          oldVal={category}\n          handleClick={handleUpdateCategory}\n        />\n        <Horizon\n          list={alphaTypes}\n          oldVal={alpha}\n          title={\"首字母:\"}\n          handleClick={handleUpdateAlpha}\n        />\n      </div>\n      <div className={styles.Container}>\n        <Scroll bounceTop={true} pullUp={handlePullUp} pullDown={handlePullDown}>\n          <div className={styles.ListWrapper}>\n            {singerList.length\n              ? singerList.map((item: any, index: number) => {\n                  return (\n                    <div\n                      key={item.accountId + \"\" + index}\n                      onClick={() => navigate(`/singers/${item.id}`)}\n                      className={styles.ListItem}\n                    >\n                      <div className={styles.ImgWrapper}>\n                        <Image\n                          src={`${item.picUrl}?param=300x300`}\n                          width=\"100%\"\n                          height=\"100%\"\n                          lazy\n                        />\n                      </div>\n                      <span>{item.name}</span>\n                    </div>\n                  );\n                })\n              : null}\n          </div>\n        </Scroll>\n      </div>\n      {enterLoading || pullDownLoading || pullUpLoading ? <Loading /> : null}\n    </div>\n  );\n};\nexport default memo(Singers);\n"],"names":["Horizon","props","list","_props$list","_props$oldVal","oldVal","title","_props$title","_props$handleClick","handleClick","listRef","useRef","useEffect","categoryDOM","current","tagElems","querySelectorAll","totalWidth","Array","from","forEach","ele","offsetWidth","style","width","concat","React","createElement","Scroll","direction","className","ref","map","item","onClick","key","name","memo","category","useState","exports","setCategory","_react$exports$useSta2","alpha","setAlpha","_react$exports$useSta4","useSelector","state","singers","singerList","enterLoading","pullDownLoading","_useSelector","pullUpLoading","pageCount","dispatch","useAppDispatch","navigate","useNavigate","changeEnterLoading","getSingerList","changePageCount","getHotSingerList","changeHotMode","category2","alpha2","hot","refreshMoreHotSingerList","refreshMoreSingerList","styles","categoryTypes","val","alphaTypes","bounceTop","pullUp","changePullDownLoading","pullDown","changePullUpLoading","length","index","accountId","id","Image","src","picUrl","height","lazy","Loading"],"mappings":"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"}